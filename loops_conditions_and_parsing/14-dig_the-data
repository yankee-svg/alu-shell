#!/usr/bin/env bash
# Define the log file (replace 'access.log' with your actual log file name)
log_file="access.log"

# Use awk to process the log file
awk '
{
    # Extract IP and HTTP status code; assuming they are in the common log format
    ip=$1
    http_code=$(NF-1) # assuming the HTTP code is the second last field
    # Combine IP and HTTP code to create a key
    key = ip " " http_code
    # Increment the count for this key
    count[key]++
}
END {
    # Output each entry in the format: OCCURRENCE_NUMBER IP HTTP_CODE
    for (entry in count) {
        print count[entry], entry
    }
}
' "$log_file" | sort -nr
